---
title: '학습한것들 정리'
date: 2020-12-17 12:21:13
category: 'learn'
draft: false
---

react key,

## 리액트의 리스트와 key

리액트에서 특정 배열에 있는 요소들을 렌더링 할때는 다음과 같이 map 함수를 사용하여 적용합니다.

```jsx
const numbers = [1, 2, 3, 4, 5];
const listItems = numbers.map((number) => <li>{number}</li>);
...
return listItems
```

위의 코드를 실행하면 리스트의 각 항목에 key를 넣어야 한다고 콘솔에 에러가 표시됩니다.  
여기서 key란 ??

### key

key는 요소들의 리스트를 만들 때 포함해야 하는 특수한 문자열 속성이라고 공식문서에 명시되어있습니다. 또한
키값은 중요하다고도 설명되어있네요.

```jsx
function NumberList(props) {
  const numbers = props.numbers
  const listItems = numbers.map(number => (
    <li key={number.toString()}>{number}</li>
  ))
  return <ul>{listItems}</ul>
}

const numbers = [1, 2, 3, 4, 5]
```

위와 같이 배열안에 반복되는 li 요소에 key속성을 주고 키 누락 문제를 해결할 수 있습니다.  
그럼 key는 왜 중요한지 살펴보았습니다.  
key는 리액트가 어떤 항목을 변경, 추가 삭제할지 식별하는 것을 돕습니다.

key는 요소에 안정적인 고유성을 부여하기 위해 배열 내부의 엘리먼트에 지정해야 합니다.

키를 선택하는 가장 좋은 방법은 리스트의 다른 항목들 사이에서 해당 항목을 고유하게 식별할 수 있는 문자열을 사용하는것이며 대부분의 경우 데이터의 id값을 키로 사용하는것이 좋다고 합니다.

```jsx
const todoItems = todos.map(todo => <li key={todo.id}>{todo.text}</li>)
```

다만 렌더링 한 항목에 안정적인 id가 없다면 최후의 수단으로 항목의 인덱스를 key로 사용하라고 안내되어있는데요.

```jsx
const todoItems = todos.map((todo, idx) => <li key={idx}>{todo.text}</li>)
```

위처럼 map함수의 2번째 인자를 받아서 인데스 값을 넣어줄 수 있습니다. 근데 여기서 또 걸리는 부분이 최후의 수단?
이라는 말입니다. 최후의 수단이라면 보통 사용하는것을 권하지 않는다 이렇게 느껴집니다.  
그 이유는 위의 key의 관한 설명과 연관되는 부분인데 항목의 순서가 바뀔 수 있는 경우 key에 인덱스값을 사용하면 성능이
저하되거나 컴포넌트의 State와 관련된 문제가 발생할 수 있습니다. 또한 명시적으로 key를 지정하지 않으면 react가 기본적으로 인덱스를 key로 사용합니다.
그렇기에 키값을 명시해주는게 중요하다고 할 수 있습니다. 삭제, 수정등 변경사항이 없다면 간편하게 index값을 사용해도 될 것 같은데, 그렇지 않다면 인덱스를 사용하는것을 지양해야 합니다.  
데이터에서 참고할 id 값이 만약 없다면?  
id-generator 같은 라이브러리들을 사용할 수 있습니다.

## next.js에 styled-component 적용

next.js는 csr을 하는 리액트앱을 서버에서 렌더링 할 수 있게 해주는 프레임워크입니다.
그렇기에 약간의 동작방식도 차이가 있었는데, 그 중 하나가 스타일드컴포넌트 적용입니다.  
서버사이드렌더링을 하면서 css파일이 나중에 적용되면서 화면이 깜박이거나, 입히기 전에 html 파일이
그대로 노출이 되었습니다. 하지만 친절하게 예제들이 많았기에 금방 해결할 수 있었습니다.

```
npm i --save-dev babel-plugin-styled-components
```

스타일드 컴포넌트 바벨 플러그인을 설치합니다.

```js
// .babelrc
{
  "presets": ["next/babel"],
  "plugins": [["styled-components", { "ssr": true }]]
}
```

babelrc파일에 위의 코드를 적용해줍니다.
